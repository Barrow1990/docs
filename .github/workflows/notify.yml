name: Notify
on: push
jobs:
  await:
    runs-on: ubuntu-latest
    outputs:
      deploy_status: ${{ steps.cf-pages.outputs.success }}
    permissions:
      contents: read
      deployments: write
    steps:
    - name: Await CF Pages
      id: cf-pages
      uses: WalshyDev/cf-pages-await@v1
      with:
        apiToken: ${{ secrets.CF_API_TOKEN }}

        accountId: '86b9f680e99b6d172395cc7309a9d8a8'
        project: 'docs'
        # Add this if you want GitHub Deployments (see below)
        githubToken: ${{ secrets.GH_TOKEN }}

  webhook:
    name: 'webhook'
    runs-on: self-hosted
    needs: await
    if: always()
    steps:
      - uses: technote-space/workflow-conclusion-action@v3
      - uses: sarisia/actions-status-discord@v1
        if: always()
        with:
          webhook: ${{ secrets.DISCORD_TEST }}
          status: ${{ needs.deploy_status.outputs.deploy_status }}
